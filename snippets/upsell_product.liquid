<script>{%- for product in collections.all.products -%}{%- if product.type != "Part"-%}{%- assign upcell_products_info = product.metafields['shopify--discovery--product_recommendation'].complementary_products.value -%}{%- for upcell_product in upcell_products_info -%}{%- assign collection_handles = upcell_product.collections | map: 'handle' -%}var upsell_prod={upsell_id:{{- upcell_product.id | json -}},upsell_parent_id:{{- product.id | json -}},upsell_variant_id:{{ upcell_product.selected_or_first_available_variant.id | json }},upsell_image:{{ upcell_product.featured_image | json }},upsell_title:{{ upcell_product.title | json }},upsell_parent_title:{{ product.title | json }},upsell_price:{{ upcell_product.price | money | json }},upsell_handle:{{upcell_product.handle | json}},upsell_url:{{upcell_product.url | json}},upsell_details_text:"{{ 'general.view_product_details_html' | t | escape }}",upsell_full_description:"{{ upcell_product.description | split: '<!-- split -->' | first | json | escape }}",upsell_regular_description:"{{ upcell_product.description | strip_html | truncatewords: settings.description_words | replace: 'Description', '' | replace: 'Dimensions', '' | replace: 'Details', '' | replace: 'Specs', '' | replace: 'Shipping', '' | replace: 'Size', '' | json | escape }}",upsell_images:"{% for image in upcell_product.images %}{{ image.id }} || {{ image.alt | escape }} ||{% endfor %}",upsell_collection_handles:"{{ collection_handles | join: ','}}",upsell_variants_size:{{upcell_product.variants.size | json}}};window.upsell_products.push(upsell_prod);{%- endfor -%}{%- for variant in product.variants -%}{%- if variant.metafields.custom.filter_hitch_size_compatibility != blank -%}window.product_variants.push({'id':{{ variant.id | json }},'no_of_bike':{{ variant.metafields.custom.filter_number_of_bikes_compatibility.value | json }},'meta_val':{{ variant.metafields.custom.filter_hitch_size_compatibility.value | json }}});{%- endif -%}{%- endfor -%}{%- endif -%}{%- endfor -%}</script>
